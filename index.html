<!doctype html>
<p id="status"></p>
</form>
</div>


<script>
const ENDPOINT = 'YOUR_APPS_SCRIPT_WEB_APP_URL';


const rank1 = document.getElementById('rank1');
const rank2 = document.getElementById('rank2');
const rank3 = document.getElementById('rank3');


const options = ['A','B','C','D','E'];


function updateRankings() {
const exclude = [rank1.value];
rank2.innerHTML = '<option value="">Select…</option>' + options.filter(o => !exclude.includes(o)).map(o => `<option value="${o}">Option ${o}</option>`).join('');
rank3.innerHTML = '<option value="">Select…</option>' + options.filter(o => ![rank1.value, rank2.value].includes(o)).map(o => `<option value="${o}">Option ${o}</option>`).join('');
}


rank1.addEventListener('change', updateRankings);
rank2.addEventListener('change', updateRankings);


function showWhyFields() {
document.querySelectorAll('fieldset[id^="why_"]').forEach(fs => fs.classList.add('hidden'));
[rank1.value, rank2.value, rank3.value].forEach((val, idx) => {
if (val) {
document.getElementById('why_' + val)?.classList.remove('hidden');
}
});
}


rank1.addEventListener('change', showWhyFields);
rank2.addEventListener('change', showWhyFields);
rank3.addEventListener('change', showWhyFields);


document.getElementById('survey').addEventListener('submit', async (e) => {
e.preventDefault();
const fd = new FormData(e.target);
fd.append('user_agent', navigator.userAgent);


const res = await fetch(ENDPOINT, {
method: 'POST',
body: new URLSearchParams(fd)
});
const json = await res.json();
const status = document.getElementById('status');
if (json.ok) {
status.textContent = 'Thanks! Your response has been saved.';
status.className = 'success';
} else {
status.textContent = 'Error: ' + (json.error || 'Unknown');
status.className = 'error';
}
});
</script>
</body>
</html>